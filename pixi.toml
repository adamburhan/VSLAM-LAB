[workspace]
name = "VSLAM-LAB"
version = "0.1.0"
description = "VSLAM-LAB"
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[tasks]
clean-swap = { cmd = "sudo /sbin/swapoff -a && sudo /sbin/swapon -a" }
kill-all = { cmd = "pkill -f -e 'droidslam|dpvo|mast3rslam|monogs|orbslam2|orbslam3|anyfeature|okvis2|colmap|glomap|vggt|pycuvslam|vslamlab' && sudo /sbin/swapoff -a && sudo /sbin/swapon -a" } 

[environments]
vslamlab = { features = ["vslamlab"]}
cuda126 = { features = ["cuda126"], solve-group = "cuda126" }
py10 = { features = ["py10"], solve-group = "py10" }
py11 = { features = ["py11"], solve-group = "py11" }
x11 = { features = ["x11"], solve-group = "x11" }
opengl = { features = ["opengl"], solve-group = "opengl" }

mast3rslam = { features = ["mast3rslam", "cuda126", "py11"], solve-group = "mast3r" }
droidslam = { features = ["droidslam", "cuda126", "py11"], solve-group = "droid" }
dpvo = { features = ["dpvo", "cuda126", "py11"], solve-group = "droid" }
monogs = { features = ["monogs"], solve-group = "monogs" }
orbslam2 = { features = ["orbslam2"], solve-group = "orb" }
anyfeature = { features = ["anyfeature"], solve-group = "anyfeature" }
colmap = { features = ["colmap"], solve-group = "colmap" }
glomap = { features = ["glomap", "colmap"], solve-group = "colmap" }
orbslam3 = { features = ["orbslam3"], solve-group = "orb" }
okvis2 = { features = ["okvis2"], solve-group = "okvis" }
pycuvslam = { features = ["pycuvslam","cuda126", "py10"] }
vggt = { features = ["vggt", "cuda126", "py11"], solve-group = "vggt" }
vggtslam = { features = ["vggtslam", "cuda126", "py11"], solve-group = "vggt" }

mast3rslam-dev = { features = ["mast3rslam-dev", "cuda126", "py11"], solve-group = "mast3r" }
droidslam-dev = { features = ["droidslam-dev", "cuda126", "py11"], solve-group = "droid" }
dpvo-dev = { features = ["dpvo-dev", "cuda126", "py11", "x11", "opengl"], solve-group = "droid" }
monogs-dev = { features = ["monogs-dev", "cuda126", "py10"], solve-group = "monogs" }
orbslam2-dev = { features = ["orbslam2-dev", "x11", "opengl"], solve-group = "orb" }
anyfeature-dev = { features = ["anyfeature-dev", "x11", "opengl"], solve-group = "anyfeature" }
orbslam3-dev = { features = ["orbslam3-dev", "x11", "opengl"], solve-group = "orb" }
okvis2-dev = { features = ["okvis2-dev", "cuda126", "py11"], solve-group = "okvis" }
vggtslam-dev = { features = ["vggtslam-dev", "cuda126", "py11", "vggt"], solve-group = "vggt" }

lightglue = { features = ["lightglue", "cuda126", "py11"], solve-group = "lightglue" }

# VSLAM-LAB main pipeline    
[feature.vslamlab]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.vslamlab.tasks]
vslamlab.cmd = "python vslamlab_gui.py vslamlab {{ exp_yaml }} {{ overwrite }}"
vslamlab.args = [
  { "arg" = "exp_yaml", "default" = "configs/exp_vslamlab.yaml" },
  { "arg" = "overwrite", "default" = " " },
]

evaluate.cmd = "python vslamlab_gui.py evaluate_exp {{ exp_yaml }} {{ overwrite }}"
evaluate.args = [
  { "arg" = "exp_yaml", "default" = "configs/exp_debug.yaml" },
  { "arg" = "overwrite", "default" = " " },
]

compare.cmd = "python vslamlab_gui.py compare_exp {{ exp_yaml }}"
compare.args = [
  { "arg" = "exp_yaml", "default" = "configs/exp_debug.yaml" }
]

get-resources.cmd = "python vslamlab_gui.py get-resources {{ exp_yaml }}"
get-resources.args = [
  { "arg" = "exp_yaml", "default" = "configs/exp_vslamlab.yaml" }
]

vslamlab-debug.depends-on = [{ "task" = "vslamlab", "args" = ["configs/exp_debug.yaml", "--overwrite"] }]
vslamlab-allfeature = [{ "task" = "vslamlab", "args" = ["configs/exp_allfeature.yaml", "--overwrite"] }]
demo = "python vslamlab_gui.py demo"

evaluate-debug.depends-on = [{ "task" = "evaluate", "args" = ["configs/exp_debug.yaml", "--overwrite"] }]
evaluate-allfeature = [{ "task" = "evaluate", "args" = ["configs/exp_allfeature.yaml", "--overwrite"] }]
compare-debug.depends-on = [{ "task" = "compare", "args" = ["configs/exp_debug.yaml"] }]
compare-allfeature = [{ "task" = "compare", "args" = ["configs/exp_allfeature.yaml"] }]

# VSLAM-LAB info functions   
baseline-info = "python vslamlab_gui.py baseline_info"
print-baselines = "python vslamlab_gui.py print_baselines"
print-datasets = "python vslamlab_gui.py print_datasets"
set-benchmark-path  = "python path_constants.py set_VSLAMLAB_BENCHMARK_path"
set-evaluation-path = "python path_constants.py set_VSLAMLAB_EVALUATION_path"

# VSLAM-LAB pipeline functions
validate-experiment-yaml = "python vslamlab_gui.py validate_experiment_yaml"
overwrite-exp = "python vslamlab_gui.py overwrite_exp"
update-experiment-csv-logs = "python vslamlab_gui.py update_experiment_csv_logs"

check-experiment-resources = "python vslamlab_gui.py check_experiment_resources"
get-experiment-resources = "python vslamlab_gui.py get_experiment_resources"

check-experiment-state = "python vslamlab_gui.py check_experiment_state"

install-baseline = "python vslamlab_gui.py install_baseline"
install-baselines = "python vslamlab_gui.py install_baselines"

download-sequence = "python vslamlab_gui.py download_sequence"
download-sequences = "python vslamlab_gui.py download_sequences"
download-dataset = "python vslamlab_gui.py download_dataset"
download-datasets = "python vslamlab_gui.py download_datasets"

run-exp = "python vslamlab_gui.py run_exp"
evaluate-exp = "python vslamlab_gui.py evaluate_exp"
compare-exp = "python vslamlab_gui.py compare_exp"

[feature.vslamlab.dependencies]
python = "*"
pyyaml = "*"
matplotlib = "*"
pandas = "*"
py-opencv = "*"
scipy = "*"
requests = "*"
inputimeout = "*"
scikit-learn = "*"
tqdm = "*"
google-api-python-client = "*"
google-auth-oauthlib = "*"
huggingface_hub = "*"
py7zr = "*"
exifread = "*"
pyproj = "*"
nvidia-ml-py = "*"
evo = "*"
git-lfs = "*"
piexif = "*"
psutil = "*"
loguru = "*"
utm = "*"
7zip = "*"

########################################################################################################################
########################################################################################################################
# droidslam 
[feature.droidslam]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.droidslam.system-requirements]
cuda = "12.0"

[feature.droidslam.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/droidslam-vslamlab Baselines/DROID-SLAM'
execute-mono = 'vslamlab_droidslam_mono'
execute-rgbd = 'vslamlab_droidslam_rgbd'
execute-stereo = 'vslamlab_droidslam_stereo'

[feature.droidslam.dependencies]
droidslam-vslamlab = "*"
lietorch = { version = "*", channel = "fontan" }  

# ########################################################################################################################
# ########################################################################################################################
# mast3rslam 
[feature.mast3rslam]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.mast3rslam.system-requirements]
cuda = "12.0"

[feature.mast3rslam.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/mast3rslam-vslamlab Baselines/MASt3R-SLAM'
execute-mono = 'vslamlab_mast3rslam_mono'

[feature.mast3rslam.dependencies]
mast3rslam-vslamlab = { channel = "fontan" }
lietorch = { channel = "fontan" }
moderngl-window = { channel = "fontan" }
roma = { channel = "fontan" }

########################################################################################################################
########################################################################################################################
# dpvo
[feature.dpvo]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.dpvo.system-requirements]
cuda = "12.0"

[feature.dpvo.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/dpvo-vslamlab Baselines/DPVO'
execute-mono = 'vslamlab_dpvo_mono'

[feature.dpvo.dependencies]
dpvo-vslamlab = { channel = "fontan" }
pangolin = { channel = "fontan" }
pypose = { channel = "fontan" }
opencv = "*"
evo = "*"
yacs = "*"
pytorch_scatter = "*"
einops = "*"   
numba = "*"

########################################################################################################################
########################################################################################################################
# monogs
[feature.monogs]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.monogs.system-requirements]
cuda = "12.0"

[feature.monogs.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/monogs-vslamlab Baselines/MonoGS'
execute-mono = 'vslamlab_monogs_mono'
execute-rgbd = 'vslamlab_monogs_rgbd'

[feature.monogs.dependencies]
monogs-vslamlab = { channel = "fontan" }
pytorch-gpu = "*"
munch = "*"
wandb = "*"
plyfile = "*"
opencv = "*"
pyglfw = "*"
imgviz = "*"
pyopengl = "*"
pyglm = "*"
rich = "*"
trimesh = "*"
evo = "*"
torchmetrics = "*"

[feature.monogs.pypi-dependencies]
open3d = "==0.17.0"

########################################################################################################################
########################################################################################################################
# orbslam2
[feature.orbslam2]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.orbslam2.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/orbslam2-vslamlab Baselines/ORB-SLAM2'
execute-mono = 'vslamlab_orbslam2_mono'
execute-rgbd = 'vslamlab_orbslam2_rgbd'
execute-stereo = 'vslamlab_orbslam2_stereo'

[feature.orbslam2.dependencies]
orbslam2-vslamlab = { channel = "fontan" }
pangolin = { channel = "fontan" }
opencv = ">=4.10.0 ,<5"

########################################################################################################################
########################################################################################################################
# anyfeature
[feature.anyfeature]
channels = ["fontan", "https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.anyfeature.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/anyfeature-vslamlab Baselines/AnyFeature-VSLAM'
execute-mono = 'vslamlab_anyfeature_mono'

[feature.anyfeature.dependencies]
anyfeature-vslamlab = { channel = "fontan" }
pangolin = { channel = "fontan" }
brisk = { channel = "fontan" }
akaze = { channel = "fontan" }
siftgpu = { channel = "fontan" }
g2o = { channel = "fontan" }
opencv = { channel = "fontan" }

########################################################################################################################
########################################################################################################################
# colmap
[feature.colmap]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.colmap.system-requirements]
cuda = "12.6"

[feature.colmap.tasks]
git-clone = { cmd = 'git clone https://huggingface.co/vslamlab/colmap-vslamlab colmap', cwd = 'Baselines' }
execute-mono = './Baselines/colmap/colmap_reconstruction.sh'

[feature.colmap.dependencies]
colmap = { build = "*cuda*" }
yq = "*"
numpy = "*"
scipy = "*"
pandas = "*"
sqlite = "*"
opencv = "*"
tqdm = "*"

########################################################################################################################
########################################################################################################################
# glomap
[feature.glomap]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.glomap.system-requirements]
cuda = "12.6"

[feature.glomap.tasks]
git-clone = { cmd = 'git clone https://huggingface.co/vslamlab/glomap-vslamlab glomap', cwd = 'Baselines' }
execute-mono = { cmd = './Baselines/glomap/glomap_reconstruction.sh' }

[feature.glomap.dependencies]
glomap = { build = "*cuda*"}

########################################################################################################################
########################################################################################################################
# orbslam3
[feature.orbslam3]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.orbslam3.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/orbslam3-vslamlab Baselines/ORB-SLAM3'
execute-mono = 'vslamlab_orbslam3_mono'
execute-rgbd = 'vslamlab_orbslam3_rgbd'
execute-stereo = 'vslamlab_orbslam3_stereo'
execute-mono-vi = 'vslamlab_orbslam3_mono_vi'
execute-rgbd-vi = 'vslamlab_orbslam3_rgbd_vi'
execute-stereo-vi = 'vslamlab_orbslam3_stereo_vi'

[feature.orbslam3.dependencies]
orbslam3-vslamlab = { channel = "fontan" }
pangolin = { channel = "fontan" }
opencv = ">=4.10.0 ,<5"

########################################################################################################################
########################################################################################################################
# okvis2
[feature.okvis2]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.okvis2.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/okvis2-vslamlab Baselines/OKVIS2'
execute-mono-vi = 'vslamlab_okvis2_mono_vi'

[feature.okvis2.dependencies]
okvis2-vslamlab = { channel = "fontan" }

########################################################################################################################
########################################################################################################################
# pycuvslam
[feature.pycuvslam]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.pycuvslam.system-requirements]
cuda = "12.0"

[feature.pycuvslam.tasks]
git-clone = './git-clone.sh VSLAM-LAB PyCuVSLAM-VSLAM-LAB PyCuVSLAM'
install = { cmd = "pip install -e bin/x86_64", cwd = "Baselines/PyCuVSLAM" }
execute-mono = { cmd = 'export LD_LIBRARY_PATH=$CONDA_PREFIX/lib:$LD_LIBRARY_PATH && python vslamlab_pycuvslam_mono.py',  cwd = 'Baselines/PyCuVSLAM' }
execute-rgbd = { cmd = 'export LD_LIBRARY_PATH=$CONDA_PREFIX/lib:$LD_LIBRARY_PATH && python vslamlab_pycuvslam_rgbd.py',  cwd = 'Baselines/PyCuVSLAM' }
execute-stereo = { cmd = 'export LD_LIBRARY_PATH=$CONDA_PREFIX/lib:$LD_LIBRARY_PATH && python vslamlab_pycuvslam_stereo.py',  cwd = 'Baselines/PyCuVSLAM' }
execute-stereo-vi = { cmd = 'export LD_LIBRARY_PATH=$CONDA_PREFIX/lib:$LD_LIBRARY_PATH && python vslamlab_pycuvslam_stereo_vi.py',  cwd = 'Baselines/PyCuVSLAM' }

[feature.pycuvslam.dependencies]
libstdcxx-ng = "*"
numpy = "=2.2.4"
pillow = "=11.1.0"
pyyaml = "=6.0.2"
rerun-sdk = "=0.22.1"
scipy = "=1.14.1"
pandas = "*"
opencv = "*"

# ########################################################################################################################
# ########################################################################################################################
# vggt
[feature.vggt]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.vggt.dependencies]

# Core Libraries
pytorch-gpu = "*"
torchvision = "*"

numpy = "<2"
Pillow = "*"
huggingface_hub = "*"
einops = "*"
safetensors = "*"
opencv = "*"
tqdm = "*"
hydra-core = "*"
omegaconf = "*"
scipy = "*"
onnxruntime = "*"
requests = "*"
trimesh = "*"
matplotlib = "*"
gradio = "==6.2.0"
viser = "*"

[feature.vggt.tasks]
git-clone = "./git-clone.sh VSLAM-LAB vggt-VSLAM-LAB VGGT"
execute-mono = { cmd = 'python vslamlab_vggt.py', cwd = "Baselines/VGGT" }

########################################################################################################################
########################################################################################################################
# vggtslam
[feature.vggtslam]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.vggtslam.dependencies]
vggtslam-vslamlab = { channel = "fontan" }
gtsam = { channel = "fontan" }
tqdm = "*"
viser = "*"
termcolor = "*"
pytorch-lightning = "*"
huggingface_hub = "*"
pytorch-metric-learning = "*"

[feature.vggtslam.tasks]
git-clone = 'git clone https://huggingface.co/vslamlab/vggtslam-vslamlab Baselines/VGGT-SLAM'
execute-mono = { cmd = 'vslamlab_vggtslam_mono', cwd = "Baselines/VGGT-SLAM" }

########################################################################################################################
########################################################################################################################
################################################ DEVELOPMENT PACKAGES ##################################################
########################################################################################################################
########################################################################################################################

# ########################################################################################################################
# ########################################################################################################################
# cuda126 
[feature.cuda126]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.cuda126.system-requirements]
cuda = "12.0"

[feature.cuda126.dependencies]
# CUDA Build Tools
cuda-compiler = "*"
cuda-version = "12.6.*"
cuda-cudart-dev = "*"
cuda-crt = "*"
libcusparse-dev = "*"
cuda-driver-dev = "*"
cuda-nvcc = "*"
cuda-nvrtc-dev = "*"
cuda-nvtx = "*"
cuda-nvtx-dev = "*"
cuda-nvml-dev = "*"
cuda-profiler-api = "*"

# CUDA Libraries
cudnn = "*"
libcublas-dev = "*"
libcudss-dev = "*"
libcufile-dev = "*"
libcufft-dev = "*"
libcurand-dev = "*"
libcusolver-dev = "*"
cusparselt = "*"
libnvjitlink = "*"

# ########################################################################################################################
# py10
[feature.py10]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.py10.dependencies]
python = "3.10.*"
setuptools = "*"
pip = "*"

# ########################################################################################################################
# py11
[feature.py11]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.py11.dependencies]
python = "3.11.*"
setuptools = "*"
pip = "*"

# ########################################################################################################################
# x11
[feature.x11]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.x11.dependencies]
xorg-libxext = "*"
xorg-libx11 = "*"
xorg-libxfixes = "*"
xorg-libxrender = "*"
xorg-libice = "*"
xorg-libsm = "*"
xorg-libxdmcp = "*"
xorg-libxau = "*"
xorg-xorgproto = "*"
libxkbcommon = "*"

# ########################################################################################################################
# opengl
[feature.opengl]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.opengl.dependencies]
libgl-devel = "*"
libegl-devel = "*"
libglvnd-devel = "*"
libopengl-devel = "*"

########################################################################################################################
########################################################################################################################
# droidslam-dev
[feature.droidslam-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.droidslam-dev.system-requirements]
cuda = "12.0"

[feature.droidslam-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB DROID-SLAM-VSLAM-LAB DROID-SLAM-DEV"
install = { cmd = "python setup.py install", cwd = "Baselines/DROID-SLAM-DEV" }
execute-mono = { cmd = 'python vslamlab_droidslam_mono.py',  cwd = 'Baselines/DROID-SLAM-DEV' }
execute-rgbd = { cmd = 'python vslamlab_droidslam_rgbd.py',  cwd = 'Baselines/DROID-SLAM-DEV' }
execute-stereo = { cmd = 'python vslamlab_droidslam_stereo.py',  cwd = 'Baselines/DROID-SLAM-DEV' }
#train = {cmd = 'python train.py --iters 1 --steps 50000 --lr 0.000025 --datapath /home/fontan/VSLAM-LAB-Benchmark/TartanAir --ckpt "droid.pth"',  cwd = 'Baselines/DROID-SLAM-DEV'}

train.cmd =  'python train.py --iters {{ iters }} --steps {{ steps }} --lr {{ lr }} --datapath {{ datapath }} --ckpt {{ ckpt }}'
train.cwd =  'Baselines/DROID-SLAM-DEV'
train.args = [
  { "arg" = "iters", "default" = "1" },
  { "arg" = "steps", "default" = "50000" },
  { "arg" = "lr", "default" = "0.000025" },
  { "arg" = "datapath", "default" = "/home/fontan/VSLAM-LAB-Benchmark/TartanAir" },
  { "arg" = "ckpt", "default" = "droid.pth" },
]

[feature.droidslam-dev.dependencies]
# Build Tools
compilers = "*"
cmake = "*"
make = "*"

# Specialized Libraries
lietorch = { version = "*", channel = "fontan" }  

# Core Libraries
pytorch-gpu = "*"
opencv = "*"
torch-scatter = "*"
torchvision = "*"
tensorboard = "*"

# Logging, Evaluation & Visualization
open3d = "*"
scipy = "*"
suitesparse = "*"
matplotlib = "*"
pyyaml = "*"
huggingface_hub = "*"
tqdm = "*"
pandas = "*"
eigen = "*"
moderngl = "*"
moderngl-window = "=3.1.1" 

# ########################################################################################################################
# ########################################################################################################################
# mast3rslam-dev
[feature.mast3rslam-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.mast3rslam-dev.system-requirements]
cuda = "12.0"

[feature.mast3rslam-dev.tasks]
git-clone = './git-clone.sh VSLAM-LAB MASt3R-SLAM-VSLAM-LAB MASt3R-SLAM-DEV'
install = { cmd = "pip install -e thirdparty/mast3r --no-build-isolation && pip install -e thirdparty/in3d --no-build-isolation && pip install --no-build-isolation -e .", cwd = "Baselines/MASt3R-SLAM-DEV" }

execute-mono = { cmd = 'python vslamlab_mast3rslam_mono.py',  cwd = 'Baselines/MASt3R-SLAM-DEV' }

[feature.mast3rslam-dev.dependencies]
# Build Tools
compilers = "*"
pkg-config = "*"
cmake = "*"
make = "*"

# Torch libraries
pytorch-gpu = "*"
torchvision = "*"
lietorch = { version = "*", channel = "fontan" }
torchcodec = "*"

# Other
eigen = "*"
einops = "*"
evo = "*"
faiss = "*"
gradio = "*"
huggingface_hub = "*"
librealsense= "*"
matplotlib = "*"
moderngl = "*"
moderngl-window = "=2.4.6"
msgpack-python = "*"
natsort = "*"
numpy = "<2"
opencv = "*"
pillow = "*"
plyfile = "*"
pyaml = "*"
pyglet = "*"
pyglfw = "=2.9.0"
pyglm = "*"
pykdtree = "*"
roma = { version = "*", channel = "fontan" }
safetensors = "*"
scikit-learn = "*"
scipy = "*"
tensorboard = "*"
tqdm = "*"
trimesh = "*"
pyrealsense2 = "*"

########################################################################################################################
########################################################################################################################
# dpvo-dev
[feature.dpvo-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.dpvo-dev.system-requirements]
cuda = "12.0"

[feature.dpvo-dev.tasks]
git-clone = './git-clone.sh VSLAM-LAB DPVO-VSLAM-LAB DPVO-DEV'
install_DPViewer = { cmd = "pip install . --no-deps --no-build-isolation --use-pep517", cwd = "Baselines/DPVO-DEV/DPViewer" }
install = { cmd = "pip install . --no-deps --no-build-isolation", cwd = "Baselines/DPVO-DEV", depends-on = ["install_DPViewer"] }
execute-mono = { cmd = 'python vslamlab_dpvo_mono.py' ,cwd = 'Baselines/DPVO-DEV' }

[feature.dpvo-dev.dependencies]
# Build Tools
compilers = "*"
pkg-config = "*"
cmake = "*"
make = "*"

# Python & Build Tools
pybind11 = "*"
glew = "*"
wayland = "*"

# Torch libraries
pytorch-gpu = "*"
torchvision = "*"
pytorch_scatter = "*"

# Core Libraries
numpy = "*"
tqdm = "*"
einops = "*"
opencv = "*"
eigen = "*"

# Specialized Libraries
pypose = { channel = "fontan" }
plyfile = "*"

# Logging, Evaluation & Visualization
pangolin = { channel = "fontan" }
tensorboard = "*"
evo = "*"
numba = "*"
kornia  = "*"   
yacs = "*"

########################################################################################################################
########################################################################################################################
# monogs-dev
[feature.monogs-dev]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.monogs-dev.system-requirements]
cuda = "12.0"

[feature.monogs-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB MonoGS-VSLAM-LAB MonoGS-DEV"
install = { cmd = "pip install submodules/simple-knn submodules/diff-gaussian-rasterization --no-deps --no-build-isolation", cwd = "Baselines/MonoGS-DEV" }
execute-mono = { cmd = 'python vslamlab_monogs_mono.py', cwd = "Baselines/MonoGS-DEV" }
execute-rgbd = { cmd = 'python vslamlab_monogs_rgbd.py', cwd = "Baselines/MonoGS-DEV" }

[feature.monogs-dev.dependencies]
# Build Tools
compilers = "*"
pkg-config = "*"
cmake = "*"
make = "*"

# Core Libraries
pytorch-gpu = "*"
torchvision = "*"
pytorch_scatter = "*"
numpy = "<2"
opencv = "*"

# Logging, Evaluation & Visualization
evo = "*"
plyfile = "*"
munch = "*"
trimesh = "*"
wandb = "*"
torchmetrics = "*"
imgviz = "*"
pyopengl = "*"
glfw = "*"
pyglm  = "*"
lpips = "*"
rich = "*"
ruff = "*"
nbformat = "==5.7.0"
pyglfw = "*"

[feature.monogs-dev.pypi-dependencies]
open3d = "==0.17.0"

########################################################################################################################
########################################################################################################################
# orbslam2-dev
[feature.orbslam2-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.orbslam2-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB ORB-SLAM2-VSLAM-LAB ORB-SLAM2-DEV"
install = { cmd = "./build.sh", cwd = "Baselines/ORB-SLAM2-DEV" }
execute-mono = { cmd = "./bin/vslamlab_orbslam2_mono",  cwd = "Baselines/ORB-SLAM2-DEV" }
execute-rgbd = { cmd = "./bin/vslamlab_orbslam2_rgbd",  cwd = "Baselines/ORB-SLAM2-DEV" }
execute-stereo = { cmd = "./bin/vslamlab_orbslam2_stereo",  cwd = "Baselines/ORB-SLAM2-DEV" }

[feature.orbslam2-dev.dependencies]
compilers = "*"
ninja = ">=1.12.1 ,<1.13"
cmake = ">=3.31.1 ,<3.32"
pkg-config = ">=0.29.2 ,<0.30"
opencv = ">=4.10.0 ,<5"
eigen = ">=3.4.0 ,<3.5.0"
yaml-cpp = ">=0.8.0,<0.9"
pangolin = { channel = "fontan" }

########################################################################################################################
########################################################################################################################
# anyfeature-dev
[feature.anyfeature-dev]
channels = ["fontan", "https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.anyfeature-dev.tasks]
git-clone = "./git-clone.sh alejandrofontan AnyFeature-VSLAM AnyFeature-VSLAM-DEV"
install = { cmd = "./build.sh", cwd = "Baselines/AnyFeature-VSLAM-DEV" }
execute-mono = { cmd = "./bin/vslamlab_anyfeature_mono",  cwd = "Baselines/AnyFeature-VSLAM-DEV" }

[feature.anyfeature-dev.dependencies]
compilers = "*"
ninja = ">=1.12.1 ,<1.13"
cmake = ">=3.29.4 ,<3.32"
pkg-config = ">=0.29.2 ,<0.30"
eigen  = ">=3.4.0 ,<3.5.0"
yaml-cpp = ">=0.8.0,<0.9"
opencv = { channel = "fontan" }
pangolin = { channel = "fontan" }
brisk = { channel = "fontan" }
akaze = { channel = "fontan" }
siftgpu = { channel = "fontan" }
g2o = { channel = "fontan" }

huggingface_hub = "*"
pandas = "*"

# ########################################################################################################################
# ########################################################################################################################
# orbslam3-dev
[feature.orbslam3-dev]
channels = ["https://prefix.dev/conda-forge", "fontan"]
platforms = ["linux-64"]

[feature.orbslam3-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB ORB-SLAM3-VSLAM-LAB ORB-SLAM3-DEV"
install = { cmd = "./build.sh", cwd = "Baselines/ORB-SLAM3-DEV" }
execute-mono = { cmd = "./bin/vslamlab_orbslam3_mono",  cwd = "Baselines/ORB-SLAM3-DEV" }
execute-rgbd = { cmd = "./bin/vslamlab_orbslam3_rgbd",  cwd = "Baselines/ORB-SLAM3-DEV" }
execute-stereo = { cmd = "./bin/vslamlab_orbslam3_stereo",  cwd = "Baselines/ORB-SLAM3-DEV" }
execute-mono-vi = { cmd = "./bin/vslamlab_orbslam3_mono_vi",  cwd = "Baselines/ORB-SLAM3-DEV" }
execute-rgbd-vi = { cmd = "./bin/vslamlab_orbslam3_rgbd_vi",  cwd = "Baselines/ORB-SLAM3-DEV" }
execute-stereo-vi = { cmd = "./bin/vslamlab_orbslam3_stereo_vi",  cwd = "Baselines/ORB-SLAM3-DEV" }

[feature.orbslam3-dev.dependencies]
compilers = "*"
ninja = ">=1.12.1 ,<1.13"
cmake = ">=3.31.1 ,<3.32"
pkg-config = ">=0.29.2 ,<0.30"
opencv = ">=4.10.0 ,<5"
eigen = ">=3.4.0 ,<3.5.0"
yaml-cpp = ">=0.8.0,<0.9"
pangolin = { channel = "fontan" }
boost = "*"

# ########################################################################################################################
# ########################################################################################################################
# okvis2-dev
[feature.okvis2-dev]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.okvis2-dev.system-requirements]
cuda = "12.0"

[feature.okvis2-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB okvis2-VSLAM-LAB OKVIS2-DEV"
install = { cmd = "./build.sh", cwd = "Baselines/OKVIS2-DEV" }
execute-mono-vi = { cmd = "./bin/vslamlab_okvis2_mono_vi",  cwd = "Baselines/OKVIS2-DEV" }

[feature.okvis2-dev.dependencies]
cmake = "<4"
glog = "*"
blas = "*"
lapack = "*"
eigen = "*"
suitesparse = "*"
boost = "*"
opencv = "*"
libtorch = "*"
librealsense = "*"
openmp = "*"
libgfortran = "3.*"
yaml-cpp = "*"

########################################################################################################################
# ########################################################################################################################
# vggtslam-dev
[feature.vggtslam-dev]
channels = ["https://prefix.dev/conda-forge" , "fontan"]
platforms = ["linux-64"]

[feature.vggtslam-dev.tasks]
git-clone = "./git-clone.sh VSLAM-LAB VGGT-SLAM-VSLAM-LAB VGGT-SLAM-DEV"
install = {cmd = './setup.sh', cwd = 'Baselines/VGGT-SLAM-DEV', depends-on = ['git-clone']}
execute-mono = { cmd = 'python3 vslamlab_vggtslam_mono.py', cwd = "Baselines/VGGT-SLAM-DEV" }

[feature.vggtslam-dev.dependencies]
# Build Tools
compilers = "*"
cmake = "*"
make = "*"

boost = "*"
unzip = "*"

# Core Libraries
pytorch-gpu = "*"
torchvision = "*"
numpy = "<2"
Pillow = "*"
huggingface_hub = "*"
einops = "*"
safetensors = "*"
opencv = "*"
tqdm = "*"
hydra-core = "*"
omegaconf = "*"
scipy = "*"
onnxruntime = "*"
requests = "*"
trimesh = "*"
matplotlib = "*"
gradio = "==6.2.0"
viser = "*"
open3d = "*"
pytorch-metric-learning = "*"
pytorch-lightning = "*"
termcolor = "*"
virtualenv = ">=20.10.0"
lz4 = "*"
gtsam = { channel = "fontan" }

# ########################################################################################################################
# ########################################################################################################################
# lightglue
[feature.lightglue]
channels = ["https://prefix.dev/conda-forge"]
platforms = ["linux-64"]

[feature.lightglue.system-requirements]
cuda = "12.6"

[feature.lightglue.tasks]
git-clone.cmd = 'git clone --recursive https://github.com/cvg/LightGlue.git'
git-clone.cwd = 'Baselines'
install = {cmd = 'python -m pip install -e .', cwd = 'Baselines/LightGlue', depends-on = ['git-clone']}

[feature.lightglue.dependencies]
# Core Libraries
pytorch-gpu = "*"
torchvision = "*"
pytorch_scatter = "*"
numpy = "*"
opencv = "*"

yq = "*"
pandas = "*"
sqlite = "*"
tqdm = "*"
pyqt = "*"
matplotlib = "*"
kornia = "*"
pyyaml = "*"
seaborn = "*"
haversine = "*"
pdf2image = "*"
pillow = "*"
pypdf2 = "*"
pymupdf = "*"
scikit-image = "*"
scikit-learn = "=1.6.1"
scipy = "=1.15.1"
faiss-cpu = "=1.8.0"
loguru = "*"
gdown = "*"
einops = "*"
pyproj = ">=3.7.1,<4"
psutil = "*"
timm = ">=1.0.15,<2"

[dependencies]
opencv = ">=4.9.0,<5"
pillow = ">=10.3.0,<13"
pyyaml = ">=6.0.2,<7"
py7zr = ">=0.17.4,<2"
colorama = ">=0.4.6,<0.5"
pandas = ">=2.3.3,<3"
